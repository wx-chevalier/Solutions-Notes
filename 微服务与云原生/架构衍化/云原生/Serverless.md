# Serverless | 无服务器架构

Serverless 无服务器是一种架构理念，其核心思想是将提供服务资源的基础设施抽象成各种服务，以 API 接口的方式供给用户按需调用，真正做到按需伸缩、按使用收费。消除了对传统的海量持续在线服务器组件的需求，降低了开发和运维的复杂性，降低运营成本并缩短了业务系统的交付周期，使得用户能够专注在价值密度更高的业务逻辑的开发上。

目前业界较为公认的无服务器架构主要包括两个方面，即提供计算资源的函数服务平台 FaaS，以及提供托管云服务的后端服务 BaaS。

- 函数即服务（Function as a Service）：是一项基于事件驱动的函数托管计算服务。通过函数服务，开发者只需要编写业务函数代码并设置运行的条件，无需配置和管理服务器等基础设施，函数代码运行在无状态的容器中，由事件触发且短暂易失，并完全由第三方管理，基础设施对应用开发者完全透明。函数以弹性、高可靠的方式运行，并且按实际执行资源计费，不执行不产生费用。

- 后端即服务（Backend as a Service）：BaaS 覆盖了应用可能依赖的所有第三方服务，如云数据库、身份验证、对象存储等服务，开发人员通过 API 和由 BaaS 服务商提供的 SDK，能够集成所需的所有后端功能，而无需构建后端应用，更不必管理虚拟机或容器等基础设施，就能保证应用的正常运行。

## 客户价值

无服务器架构是一种新的软件架构范式，它因为 AWS Lambda 服务而推广。Serverless 对客户的最大价值有两点：

- 将资本支出（CAPEX）变成了运营成本（OPEX），且能很好地解决业务“估不准问题”。Serverless 采用更精确地根据业务量所消耗的资源去支付费用，无需在事先估计业务量而先采购好计算资源。传统的通过预估业务峰值采购计算资源的方式下，如果业务量估高了就会造成采购多余的资源而带来浪费，如果业务量估少了又会使得业务价值无法最大化而让营收变窄。Serverless 从技术层面做到了可以在毫秒级实现计算资源扩容而很好地应对业务流量的波动。

- 省去了高昂的运维成本。Serverless 由于是免服务器运维的，所以不需要配置相应的人员去运维服务器。Serverless 的整个解决方案通过封装向开发者屏蔽了大量的技术细节，让开发者可以专注于业务逻辑而带去更高的开发效率和缩短业务上线时间。

可以预见，Serverless 是弹性、易用性和移植性的重要落地形式。有部分人对 Service Mesh 和 Serverless 存在这样的困惑：Service Mesh 是解决微服务软件架构下服务与服务之间复杂度问题的，只要采纳了微服务软件架构就应当使用 Service Mesh。Serverless 解决的是免服务器运维的问题，一个运用于微服务软件架构的 Serverless 解决方案，应当包含 Service Mesh 的内容，只不过对于终端的开发者很可能感知不到而已。

# FaaS

FaaS 的理念是，诸如亚马逊之类的云提供商甚至是诸如 Fission.io 或 funktion 之类的本地软件都可以提供服务，其中用户可以请求远程运行的功能以执行非常特定的任务。功能结束后，这些结果将返回给用户。不维护任何服务或有状态数据，并且用户将功能代码提供给运行该功能的服务。

无服务器架构的优势在于，不需要配置虚拟机和/或容器来构建利用 FaaS 的应用程序部分。一旦它们的功能结束，运行这些功能的计算实例从用户的角度来看就不再存在。此外，需要由用户监控和维护的微服务和/或容器的数量减少，节省了成本、时间和精力。

无服务器架构为软件工程师和架构师提供了另一种功能强大的软件构建工具，可用于设计灵活且可扩展的软件。已知的 FaaS 有 Amazon 的 AWS Lambda、Microsoft 的 Azure Functions、Google 的 Cloud Functions 等。

## 缺陷

与微服务和云原生应用程序类似，无服务器架构并不适用于所有场景。FaaS 提供的功能本身并不保持状态，这意味着在编写功能代码时需要特别注意。这与全微服务不同——开发人员可以完全控制状态。尽管有这种限制，但在 FaaS 的情况下保持状态的一种方法是将状态传播到数据库或像 Redis 这样的内存缓存。

这些功能的启动时间并不总是很快，因为要有时间分配给 FaaS 服务提供商发送请求，然后在某些情况下启动运行该功能的计算实例也需要时间。在设计无服务器应用程序时必须考虑这些延迟。FaaS 不像微服务那样持续运行，这使得它们不适合任何需要持续运行软件的任务。

无服务器应用程序具有与其他云原生应用程序相同的限制，其中应用程序从一个云提供商到另一个云提供商，或从云到本地环境的可移植性因供应商锁定而变得具有挑战性。

# BaaS

无服务器应用程序的另一个定义是使用 BaaS 或后端作为服务范式的应用程序。 BaaS 的想法是，开发人员只编写其应用程序的客户端代码，然后依赖于托管在云中的多个软件预构建服务（可通过 API 访问）。BaaS 在移动应用程序编程中很受欢迎，开发人员可以依赖大量的后端服务来驱动应用程序的大部分功能。 BaaS 服务的例子有：Firebase 和 Parse。
